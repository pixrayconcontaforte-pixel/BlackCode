document.addEventListener('DOMContentLoaded', () => {
    const loginForm = document.getElementById('loginForm');
    if(loginForm){
        loginForm.addEventListener('submit', async e => {
            e.preventDefault();
            const data = new FormData(loginForm);
            const res = await fetch('login.php',{method:'POST',body:data});
            const result = await res.json();
            document.getElementById('loginMsg').innerText = result.msg;
            if(result.success) window.location.href='dashboard.html';
        });
    }

    const cadastroForm = document.getElementById('cadastroForm');
    if(cadastroForm){
        cadastroForm.addEventListener('submit', async e => {
            e.preventDefault();
            const data = new FormData(cadastroForm);
            const res = await fetch('cadastro.php',{method:'POST',body:data});
            const result = await res.json();
            document.getElementById('cadastroMsg').innerText = result.msg;
            if(result.success) window.location.href='index.html';
        });
    }

    const saldoForm = document.getElementById('saldoForm');
    if(saldoForm){
        saldoForm.addEventListener('submit', async e => {
            e.preventDefault();
            const data = new FormData(saldoForm);
            const res = await fetch('adicionar_saldo.php',{method:'POST',body:data});
            const result = await res.json();
            if(result.success){
                document.getElementById('pixArea').innerHTML=`<img src="${result.qr_code}" alt="PIX QR Code"><p>${result.pix_code}</p>`;
            }
        });
    }
});
